<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Web - 磊子的菜园子</title><meta name=Description content="计算机网络笔记，包括网络模型、TCP/UDP 协议、页面解析过程的内容。"><meta property="og:title" content="Web"><meta property="og:description" content="计算机网络笔记，包括网络模型、TCP/UDP 协议、页面解析过程的内容。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.humblex.top/web/"><meta property="og:image" content="https://blog.humblex.top/images/avatar.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-07-17T00:00:00+00:00"><meta property="article:modified_time" content="2019-07-17T00:00:00+00:00"><meta property="og:site_name" content="磊子的菜园子"><meta property="og:see_also" content="https://blog.humblex.top/css/"><meta property="og:see_also" content="https://blog.humblex.top/front-end/"><meta property="og:see_also" content="https://blog.humblex.top/js/"><meta property="og:see_also" content="https://blog.humblex.top/js-insts/"><meta property="og:see_also" content="https://blog.humblex.top/react/"><meta property="og:see_also" content="https://blog.humblex.top/vuejs/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.humblex.top/images/avatar.jpg"><meta name=twitter:title content="Web"><meta name=twitter:description content="计算机网络笔记，包括网络模型、TCP/UDP 协议、页面解析过程的内容。"><meta name=application-name content="hzlei"><meta name=apple-mobile-web-app-title content="hzlei"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.humblex.top/web/><link rel=next href=https://blog.humblex.top/vuejs/><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/color.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Web","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.humblex.top\/web\/"},"image":["https:\/\/blog.humblex.top\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"HTTP","wordcount":2917,"url":"https:\/\/blog.humblex.top\/web\/","datePublished":"2019-07-17T00:00:00+00:00","dateModified":"2019-07-17T00:00:00+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"hzlei","logo":"https:\/\/blog.humblex.top\/images\/avatar.jpg"},"author":{"@type":"Person","name":"磊子"},"description":"计算机网络笔记，包括网络模型、TCP/UDP 协议、页面解析过程的内容。"}</script><script src=//instant.page/5.2.0 defer type=module integrity=sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z></script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"auto"==="light"||"auto"==="dark"||"auto"==="black"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=磊子的菜园子><span class=header-title-pre><i class='far fa-edit fa-fw'></i></span>hzlei</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>所有文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/about/>关于 </a><a class=menu-item href=https://github.com/hzleii title=GitHub rel="noopener noreferrer" target=_blank><i class='fab fa-github fa-fw'></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=磊子的菜园子><span class=header-title-pre><i class='far fa-edit fa-fw'></i></span>hzlei</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>所有文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/about/ title>关于</a><a class=menu-item href=https://github.com/hzleii title=GitHub rel="noopener noreferrer" target=_blank><i class='fab fa-github fa-fw'></i></a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#osi-七层与-tcpip-四层模型>OSI 七层与 TCP/IP 四层模型</a></li><li><a href=#tcp-协议>TCP 协议</a><ul><li><a href=#三次握手>三次握手</a></li><li><a href=#为什么是三次>为什么是三次</a></li><li><a href=#数据传输>数据传输</a></li></ul></li><li><a href=#udp-协议>UDP 协议</a></li><li><a href=#输入-url-到页面加载>输入 URL 到页面加载</a></li><li><a href=#dns-解析过程>DNS 解析过程</a></li><li><a href=#浏览器渲染页面的过程>浏览器渲染页面的过程</a><ul><li><a href=#webkit-渲染过程>WebKit 渲染过程</a></li><li><a href=#async-和-defer>async 和 defer</a></li><li><a href=#repaint-和-reflow-回流>repaint 和 reflow (回流)</a></li></ul></li><li><a href=#http>HTTP</a><ul><li><a href=#http-请求>HTTP 请求</a></li><li><a href=#http-响应>HTTP 响应</a></li><li><a href=#重定向链接的区别>重定向链接的区别</a></li><li><a href=#常见的信息头>常见的信息头</a></li><li><a href=#http-缓存机制>HTTP 缓存机制</a></li><li><a href=#https-过程>HTTPS 过程</a></li></ul></li><li><a href=#http-版本进步>HTTP 版本进步</a><ul><li><a href=#http09>HTTP/0.9</a></li><li><a href=#http10>HTTP/1.0</a></li><li><a href=#http11>HTTP/1.1</a></li><li><a href=#http2>HTTP/2</a></li></ul></li><li><a href=#cookie-和-session>Cookie 和 Session</a></li><li><a href=#跨域>跨域</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Web</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class="author fas fa-user-circle fa-fw"></span><a href=/ title=Author rel=author class=author>磊子</a>
</span>&nbsp;<span class=post-category>收录于 </span>&nbsp;<span class=post-category>类别 <a href=/categories/code/><i class="far fa-folder fa-fw"></i>code</a></span>&nbsp;<span class=post-category>和</span>&nbsp;<span class=post-series>系列 <a href=/series/weeb/><i class="far fa-list-alt fa-fw"></i>Weeb</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2019-07-17>2019-07-17</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2019-07-17>2019-07-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 2917 字&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 6 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#osi-七层与-tcpip-四层模型>OSI 七层与 TCP/IP 四层模型</a></li><li><a href=#tcp-协议>TCP 协议</a><ul><li><a href=#三次握手>三次握手</a></li><li><a href=#为什么是三次>为什么是三次</a></li><li><a href=#数据传输>数据传输</a></li></ul></li><li><a href=#udp-协议>UDP 协议</a></li><li><a href=#输入-url-到页面加载>输入 URL 到页面加载</a></li><li><a href=#dns-解析过程>DNS 解析过程</a></li><li><a href=#浏览器渲染页面的过程>浏览器渲染页面的过程</a><ul><li><a href=#webkit-渲染过程>WebKit 渲染过程</a></li><li><a href=#async-和-defer>async 和 defer</a></li><li><a href=#repaint-和-reflow-回流>repaint 和 reflow (回流)</a></li></ul></li><li><a href=#http>HTTP</a><ul><li><a href=#http-请求>HTTP 请求</a></li><li><a href=#http-响应>HTTP 响应</a></li><li><a href=#重定向链接的区别>重定向链接的区别</a></li><li><a href=#常见的信息头>常见的信息头</a></li><li><a href=#http-缓存机制>HTTP 缓存机制</a></li><li><a href=#https-过程>HTTPS 过程</a></li></ul></li><li><a href=#http-版本进步>HTTP 版本进步</a><ul><li><a href=#http09>HTTP/0.9</a></li><li><a href=#http10>HTTP/1.0</a></li><li><a href=#http11>HTTP/1.1</a></li><li><a href=#http2>HTTP/2</a></li></ul></li><li><a href=#cookie-和-session>Cookie 和 Session</a></li><li><a href=#跨域>跨域</a></li></ul></nav></div></div><div class=content id=content><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fwwarning"></i>警告<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>本文最后更新于 <span class=timeago datetime=2019-07-17T00:00:00 title="July 17, 2019">2019-07-17</span>，文中内容可能已过时。</div></div></div><h2 id=osi-七层与-tcpip-四层模型 class=headerLink><a href=#osi-%e4%b8%83%e5%b1%82%e4%b8%8e-tcpip-%e5%9b%9b%e5%b1%82%e6%a8%a1%e5%9e%8b class=header-mark></a>OSI 七层与 TCP/IP 四层模型</h2><ul><li><p>OSI：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层</p></li><li><p>TCP/IP：数据链路层、网络层、传输层、应用层</p></li><li><p>物理层：原始比特流传输</p></li><li><p>数据链路层：原始比特流到逻辑信号之间的转换</p></li><li><p>网络层：IP 协议</p></li><li><p>传输层：TCP 和 UDP</p></li><li><p>会话层：SSL</p></li><li><p>应用层：HTTP 和 FTP</p></li></ul><h2 id=tcp-协议 class=headerLink><a href=#tcp-%e5%8d%8f%e8%ae%ae class=header-mark></a>TCP 协议</h2><h3 id=三次握手 class=headerLink><a href=#%e4%b8%89%e6%ac%a1%e6%8f%a1%e6%89%8b class=header-mark></a>三次握手</h3><ol><li>起初两端都处于 <code>CLOSED</code> 状态，客户端向服务端发送 SYN 包等待服务端确认，客户端进入 <code>SYN-SENT</code> 状态</li><li>服务端发回 SYN + ACK 包确认连接请求，进入 <code>SYN-RCVD</code> 状态</li><li>客户端收到确认，向服务端发送 ACK 包确认建立连接，此时两端都处于 <code>ESTABLISHED</code> 状态</li></ol><p>四次挥手与三次握手类似，区别是服务端再发回确认时分为两次；第一次先发送 ACK 确认客户端发来的 FIN 包，第二次发送服务端的 FIN 包等待 ACK。</p><h3 id=为什么是三次 class=headerLink><a href=#%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%e4%b8%89%e6%ac%a1 class=header-mark></a>为什么是三次</h3><ul><li>为了实现可靠传输，协议双方都必须发送带有序列号的包，三次握手过程中则是 <code>1000 => 1001+2000 => 2001</code>；而为了保证双方都有发出的序列号并且都被确认，至少要三次连接才能完成</li><li>防止客户端认为已失效的连接请求传送到服务器端，但服务端却接受了导致错误</li></ul><h3 id=数据传输 class=headerLink><a href=#%e6%95%b0%e6%8d%ae%e4%bc%a0%e8%be%93 class=header-mark></a>数据传输</h3><ul><li>使用校验和、确认应答机制和重传机制来保证可靠传输</li><li>使用滑动窗口机制来实现流量控制，通过动态改变窗口的大小进行拥塞控制</li></ul><h2 id=udp-协议 class=headerLink><a href=#udp-%e5%8d%8f%e8%ae%ae class=header-mark></a>UDP 协议</h2><p>无连接 (握手)；不可靠传输，无流量控制和拥塞控制，支持一对多、多对多等通信；应用于部分游戏等。</p><p>QUIC 和 WebRTC 基于 RUDP。</p><h2 id=输入-url-到页面加载 class=headerLink><a href=#%e8%be%93%e5%85%a5-url-%e5%88%b0%e9%a1%b5%e9%9d%a2%e5%8a%a0%e8%bd%bd class=header-mark></a>输入 URL 到页面加载</h2><ol><li>DNS 解析</li><li>TCP 连接</li><li>发送 HTTP 请求</li><li>服务器处理请求并返回 HTTP 响应</li><li>浏览器解析渲染页面</li><li>断开 TCP 连接</li></ol><h2 id=dns-解析过程 class=headerLink><a href=#dns-%e8%a7%a3%e6%9e%90%e8%bf%87%e7%a8%8b class=header-mark></a>DNS 解析过程</h2><p>以 <code>baidu.com</code> 为例：</p><ol><li>本地 DNS 缓存</li><li>本地 DNS 服务器</li><li>根 DNS 服务器</li><li><code>com</code> 域 DNS 服务器</li><li><code>baidu.com</code> 域 DNS 服务器</li><li>(CNAME 到 CDN 域名服务器请求解析)</li></ol><h2 id=浏览器渲染页面的过程 class=headerLink><a href=#%e6%b5%8f%e8%a7%88%e5%99%a8%e6%b8%b2%e6%9f%93%e9%a1%b5%e9%9d%a2%e7%9a%84%e8%bf%87%e7%a8%8b class=header-mark></a>浏览器渲染页面的过程</h2><h3 id=webkit-渲染过程 class=headerLink><a href=#webkit-%e6%b8%b2%e6%9f%93%e8%bf%87%e7%a8%8b class=header-mark></a>WebKit 渲染过程</h3><ol><li>首先通过请求得到 HTML</li><li>解析 HTML 生成 DOM 树</li><li>遇见 CSS、图片等则异步加载，不会阻塞 DOM 树的生成</li><li>遇见普通的 JS (<code>&lt;script></code>) 则阻塞 DOM 树加载，等到 JS 加载且执行完后继续生成 DOM 树</li><li>将 DOM 树 和 CSS 规则树合并到一起生成渲染树</li><li>遍历渲染树计算节点的信息并绘制到屏幕</li></ol><h3 id=async-和-defer class=headerLink><a href=#async-%e5%92%8c-defer class=header-mark></a>async 和 defer</h3><ul><li><code>async</code>：异步下载，执行时阻塞，可能在任何时候执行，顺序与定义先后无关</li><li><code>defer</code>：异步下载，直到 DOMContentLoaded 触发前才执行，顺序由定义先后决定</li><li>动态插入：除非显式设置 <code>false</code>，否则类似 <code>async</code></li><li>一起使用：<code>async</code> 优先，浏览器不支持时回退到 <code>defer</code></li></ul><h3 id=repaint-和-reflow-回流 class=headerLink><a href=#repaint-%e5%92%8c-reflow-%e5%9b%9e%e6%b5%81 class=header-mark></a>repaint 和 reflow (回流)</h3><ol><li>repaint 是屏幕中一部分的内容重新渲染</li><li>reflow 则是因为某些元素的尺寸或存在与否改变了，因此需要重新计算相关联的所有渲染树</li><li>reflow 必然带来 repaint，但 repaint 不一定会带来 reflow</li></ol><p>获取一个元素的 <code>scrollTop</code> 和 <code>offsetTop</code> 之类的属性时，浏览器为了保证值的正确也会回流取得最新的值。</p><h2 id=http class=headerLink><a href=#http class=header-mark></a>HTTP</h2><p>超文本传输协议，本质是无状态的，使用 Cookies 可以创建有状态的会话；一般基于 TCP/IP 协议，默认端口 80；分为请求和响应两个部分。</p><h3 id=http-请求 class=headerLink><a href=#http-%e8%af%b7%e6%b1%82 class=header-mark></a>HTTP 请求</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>GET / HTTP/1.1
</span></span><span class=line><span class=cl>Host: developer.mozilla.org
</span></span><span class=line><span class=cl>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0
</span></span><span class=line><span class=cl>Accept: text/css,*/*;q=0.1
</span></span><span class=line><span class=cl>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate, br
</span></span><span class=line><span class=cl>Cookie: dwf_sg_task_completion=False; _ga=GA1.2.2100708258.1587297770
</span></span></code></pre></td></tr></table></div></div><ul><li>HTTP 方法：GET、POST、OPTIONS 等</li><li>资源路径和 HTTP 协议版本号</li><li>其他 headers</li><li>如果是例如 POST，还会包含发送的信息</li><li><code>Connection: keep-alive</code>：保持该网络连接打开</li></ul><h3 id=http-响应 class=headerLink><a href=#http-%e5%93%8d%e5%ba%94 class=header-mark></a>HTTP 响应</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>HTTP/2 200 OK
</span></span><span class=line><span class=cl>Content-Type: image/png
</span></span><span class=line><span class=cl>Content-Length: 63794
</span></span><span class=line><span class=cl>Last-Modified: Tue, 17 Dec 2019 00:26:34 GMT
</span></span><span class=line><span class=cl>Cache-Control: public,max-age=31536000,immutable
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html lang=&#34;zh&#34;&gt;
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><ul><li>HTTP 版本号</li><li>状态码和状态信息：一般由三位构成<ul><li><code>1xx</code> 表示请求已经接受</li><li><code>2xx</code> 表示请求已经处理</li><li><code>3xx</code> 重定向</li><li><code>4xx</code> 一般为客户端错误</li><li><code>5xx</code> 一般为服务器错误</li><li>常见的：<code>200 OK</code>；<code>403 Forbidden</code>；<code>404 Not Found</code>；<code>502 Bad Gateway</code></li></ul></li><li>其他 headers</li><li>信息</li></ul><h3 id=重定向链接的区别 class=headerLink><a href=#%e9%87%8d%e5%ae%9a%e5%90%91%e9%93%be%e6%8e%a5%e7%9a%84%e5%8c%ba%e5%88%ab class=header-mark></a>重定向链接的区别</h3><ul><li><code>301</code>：永久重定向，浏览器可以做缓存</li><li><code>302</code>：临时重定向，下次访问依旧用重定向之前的链接</li><li><code>307</code>：类似临时重定向，不允许请求变为 GET 类型</li><li><code>308</code>：类似永久重定向，不允许请求变为 GET 类型</li></ul><h3 id=常见的信息头 class=headerLink><a href=#%e5%b8%b8%e8%a7%81%e7%9a%84%e4%bf%a1%e6%81%af%e5%a4%b4 class=header-mark></a>常见的信息头</h3><ul><li>Host：服务器域名</li><li>User-Agent：UA</li><li>Cookie：Cookie 会一直被携带在 HTTP 请求内发送给服务器，<code>localStorage</code> 和 <code>sessionStorage</code> 仅和浏览器本地有关，且 <code>sessionStorage</code> 仅在当前浏览器窗口关闭之前有效</li><li><code>Cache-Control</code>，<code>If-Modified-Since</code>，<code>Etag</code>，<code>If-None-Match</code>：HTTP 缓存相关</li></ul><h3 id=http-缓存机制 class=headerLink><a href=#http-%e7%bc%93%e5%ad%98%e6%9c%ba%e5%88%b6 class=header-mark></a>HTTP 缓存机制</h3><ul><li><p>发送 HTTP 请求时首先检查浏览器缓存 (是否存在或是否过期)</p><ul><li>缓存有效则直接从缓存中得到资源 (强缓存)</li><li>缓存无效检查是否有 <code>Etag</code> 或 <code>Last-Modified</code><ul><li>有 <code>Etag</code> 则带 <code>If-None-Match</code> 请求资源</li><li>有 <code>Last-Modified</code> 则带 <code>If-Modified-Since</code> 请求资源<ul><li><code>304 Not Modified</code> (协商缓存) 或 <code>200 OK</code></li></ul></li><li>无则直接请求资源<ul><li><code>200 OK</code></li></ul></li></ul></li></ul></li><li><p><code>no-cache</code>：可携带 Etag 相关头实现 304 协商缓存，无强缓存</p></li><li><p><code>no-store</code>：无任何缓存</p></li></ul><h3 id=https-过程 class=headerLink><a href=#https-%e8%bf%87%e7%a8%8b class=header-mark></a>HTTPS 过程</h3><p>通过 TLS 协议对 HTTP 进行加密。</p><ol><li>客户端发送 HTTPS 请求，并发送支持的密钥算法</li><li>服务端选择一种算法返回证书 (非对称加密)</li><li>客户端验证证书的有效性，生成随机密码，并用证书公钥加密随机密码发送给服务端</li><li>服务端接收到随机密码，用私钥解密，并用这个密码加密数据发送给客户端</li><li>客户端用随机密码解密传来的数据 (对称加密)</li></ol><p>非对称加密：公钥加密私钥解密</p><h2 id=http-版本进步 class=headerLink><a href=#http-%e7%89%88%e6%9c%ac%e8%bf%9b%e6%ad%a5 class=header-mark></a>HTTP 版本进步</h2><h3 id=http09 class=headerLink><a href=#http09 class=header-mark></a>HTTP/0.9</h3><p>相当原始的 HTTP 版本，仅支持 <code>GET</code> HTML。</p><h3 id=http10 class=headerLink><a href=#http10 class=header-mark></a>HTTP/1.0</h3><ul><li>添加了 <code>POST</code>、<code>HEAD</code> 等请求</li><li><code>Content-Type</code>：文件类型支持</li><li>缓存支持</li></ul><h3 id=http11 class=headerLink><a href=#http11 class=header-mark></a>HTTP/1.1</h3><ul><li><code>Connection: keep-alive</code> 的默认支持</li><li>添加了 <code>PUT</code>、<code>PATCH</code>、<code>OPTIONS</code>、<code>DELETE</code> 等请求</li><li>新增了很多头字段、状态码</li></ul><h3 id=http2 class=headerLink><a href=#http2 class=header-mark></a>HTTP/2</h3><ul><li>服务端推送：PUSH 方法；例如请求 <code>.html</code> 时服务端主动尝试返回 <code>.css</code> 和 <code>.js</code> 等资源</li><li>多路复用：尝试将多个 HTTP 请求合并一起发送；在 HTTP/1.1 中，<code>keep-alive</code> 可以使 TCP 连接保持打开，但数据传输依旧是 <code>请求 A => 响应 A => 请求 B => 响应 B</code> 的模式，而在 HTTP/2 中，就可以实现 <code>请求 A 和 B => 响应 A 和 B</code>；在使用 HTTP/2 的情况下，&ldquo;减少 HTTP 请求&rdquo; 这类的性能优化并不一定在所有情况下都能有效</li><li>首部压缩：HTTP 头 压缩</li><li>二进制分帧：将信息分割为更小的帧，并对它们采用二进制编码，其中例如 HTTP 头会被封装到 Headers 帧</li></ul><h2 id=cookie-和-session class=headerLink><a href=#cookie-%e5%92%8c-session class=header-mark></a>Cookie 和 Session</h2><ol><li>浏览器首次请求</li><li>服务器生成 Session 并保存，响应返回特定包含 Session 信息的 Cookie</li><li>浏览器再次请求带有这个 Cookie</li><li>服务器查询 Session 判断身份</li></ol><p>区别：</p><p>Session 是在服务端保存的一个数据结构，用来跟踪用户的状态，这个数据可以保存在内存、数据库、文件中；Cookie 是客户端保存用户信息的一种机制，用来记录用户的一些信息，也是实现 Session 的一种方式。</p><h2 id=跨域 class=headerLink><a href=#%e8%b7%a8%e5%9f%9f class=header-mark></a>跨域</h2><p>同源策略：协议、端口、域名都相同</p><ol><li>JSONP 利用 <code>script</code> 标签没有跨域限制的特性，让服务器发回可执行的 JS 代码（函数），其参数就是要获取的数据。例如搜狐的当前城市 API，返回的就是 <code>var returnCitySN = {}</code></li><li>手动设置 <code>document.domain</code>，实现二级域名相同</li><li><code>frame.postMessage({})</code></li><li>CORS</li></ol><p>CORS 分为简单请求和需预检的请求：</p><p>使用 GET、POST 或 HEAD 方法，请求头的类型和 <code>Content-Type</code> 都在限定内的会发出简单请求：</p><ul><li>浏览器直接发送带有 <code>Origin</code> 头的请求</li><li>对于没有 cookie 的请求，服务器响应：<ul><li><code>Access-Control-Allow-Origin</code>：<code>*</code> 或与 <code>Origin</code> 的值相同</li></ul></li><li>对于具有凭据的请求，服务器应该设置：<ul><li><code>Access-Control-Allow-Origin</code>：与 <code>Origin</code> 的相同</li><li><code>Access-Control-Allow-Credentials</code>：<code>true</code></li></ul></li></ul><p>需预检的请求：</p><ul><li>浏览器将具有以下 header 的 OPTIONS 请求发送到相同的 URL：<ul><li><code>Access-Control-Request-Method</code>：请求方法</li><li><code>Access-Control-Request-Headers</code>：以逗号分隔的 header 列表</li></ul></li><li>服务器响应：<ul><li>HTTP 状态码：<code>200</code></li><li><code>Access-Control-Allow-Methods</code>：允许方法的列表</li><li><code>Access-Control-Allow-Headers</code>：允许 header 的列表</li><li><code>Access-Control-Max-Age</code>：缓存秒数</li></ul></li></ul><p>预检通过后才发出实际请求，与简单请求流程相同。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2019-07-17</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-source href=https://github.com/hzleii/hzleii.github.io/blog/content/posts/code/web/index.md target=_blank rel="noopener noreferrer">查看源代码</a>
</span><span>|&nbsp;<a class=link-to-edit href=https://github.com/hzleii/hzleii.github.io/edit/blog/content/posts/code/web/index.md target=_blank rel="noopener noreferrer">编辑此页</a></span></div><div class=post-info-share></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/http/>HTTP</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/vuejs/ class=next rel=next title=Vue.js>Vue.js<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=giscus></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/>giscus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer" title="Hugo 0.115.4">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreferrer" title="DoIt 0.4.0"><i class="far fa-edit fa-fw"></i> DoIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer">磊子</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class=footer-line></div><div class=footer-line></div></div><script>"serviceWorker"in navigator&&(navigator.serviceWorker.register("/sw.min.js",{scope:"/"}).then(function(){}),navigator.serviceWorker.ready.then(function(){}))</script></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div id=cookieconsent-container></div><div class=assets><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:15},comment:{giscus:{darkTheme:"dark",dataCategory:"评论",dataCategoryId:"DIC_kwDOJUTMkM4CVoj8",dataEmitMetadata:"0",dataInputPosition:"bottom",dataLang:"en",dataMapping:"pathname",dataReactionsEnabled:"1",dataRepo:"hzleii/giscus",dataRepoId:"R_kgDOJUTMkA",dataStrict:"0",lightTheme:"light"}},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!0,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.1,type:"fuse",useExtendedSearch:!1},table:{sort:!0}}</script><script type=text/javascript src=/lib/tablesort/tablesort.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js defer></script><script type=text/javascript src=/js/cookieconsent.min.js defer></script><script type=text/javascript src=https://website-card-embed.humblex.top/website-card-embed-loveit.js></script><script type=text/javascript src=/js/theme.min.js defer></script><script type=text/javascript src=/js/giscus.min.js defer></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XXBC12BWSH",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-XXBC12BWSH" async></script></div></body></html>